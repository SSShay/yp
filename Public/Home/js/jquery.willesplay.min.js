(function(b,h,g){b.fn.video=function(){function x(){y.removeClass("glyphicon-pause").addClass("glyphicon-play").fadeIn();q.addClass("playIcon")}function z(){r.play()}function A(a){a=parseInt(a);var d;if(-1<a){d=Math.floor(a/3600);var c=Math.floor(a/60)%60;a%=60;var b=parseInt(d/24);d=0<b?b+"day "+(d-24*b)+":":d+":";10>c&&(d+="0");d+=c+":";10>a&&(d+="0");d+=a}return d}var t=b(this);t.append(b('<div class="playHeader"><div class="videoName"></div></div>'));var C=b(".videoName",t),k=b('<div class="playContent"><video width="100%" src="" height="100%">\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 video\u76f4\u63a5\u64ad\u653e\uff0c\u70b9\u51fb\u8fd9\u91cc\u4e0b\u8f7d\u89c6\u9891\uff1a <a href="/">\u4e0b\u8f7d\u89c6\u9891</a></video><div class="playTip glyphicon glyphicon-play"></div></div>'),e=b('<div class="playControll"><div class="playPause playIcon"></div><div class="timebar"><span class="currentTime">0:00:00</span><div class="progress"><div class="progress-bar progress-bar-primary progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div></div><span class="duration">0:00:00</span></div><div class="otherControl"><span class="volume glyphicon glyphicon-volume-down text-primary"></span><span class="fullScreen glyphicon glyphicon-fullscreen"></span><div class="volumeBar"><div class="volumewrap"><div class="progress"><div class="progress-bar progress-bar-primary" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 8px;height: 40%;"></div></div></div></div></div></div>');t.append(k,e);var c=b("video",k),y=b(".playTip",k),q=b(".playPause",e),D=b(".currentTime",e),E=b(".duration",e),l=b(".volumeBar",e),u=b(".timebar .progress",e),v=b(".progress-bar",u),w=b(".volumewrap",l),m=b(".progress-bar",w),n=b(".volume",e),B=b(".fullScreen",e),p,r={play:function(a,d,b){a&&a!=c.attr("src")&&c.prop("src",a);C.text(d);b&&(p=b);c[0].paused?(p&&(c[0].currentTime=p.data("currentTime")||0),c[0].play(),y.removeClass("glyphicon-play").addClass("glyphicon-pause").fadeOut(),q.removeClass("playIcon")):(c[0].pause(),x())}};c[0].volume=.4;q.on("click",z);k.on("click",z);b(g).click(function(){l.hide()});c.on("loadedmetadata",function(){E.text(A(c[0].duration))});c.on("timeupdate",function(){var a=c[0].currentTime;D.text(A(a));v.css("width",100*a/c[0].duration+"%");p.data("currentTime",a)});c.on("ended",x);b(h).keyup(function(a){a=a||h.event;32==a.keyCode&&r.play();27==a.keyCode&&(B.removeClass("cancleScreen"),e.css({bottom:-48}).removeClass("fullControll"));a.preventDefault()});B.on("click",function(){b(this).hasClass("cancleScreen")?(g.exitFullscreen?g.exitFullscreen():g.mozExitFullScreen?g.mozExitFullScreen():g.webkitExitFullscreen&&g.webkitExitFullscreen(),b(this).removeClass("cancleScreen"),e.css({bottom:-48}).removeClass("fullControll")):(c[0].requestFullscreen?c[0].requestFullscreen():c[0].mozRequestFullScreen?c[0].mozRequestFullScreen():c[0].webkitRequestFullscreen?c[0].webkitRequestFullscreen():c[0].msRequestFullscreen&&c[0].msRequestFullscreen(),b(this).addClass("cancleScreen"),e.css({left:0,bottom:0}).addClass("fullControll"));return!1});n.on("click",function(a){a=a||h.event;l.toggle();a.stopPropagation()});l.on("click mousewheel DOMMouseScroll",function(a){a=a||h.event;var b;b=a||h.event;var e=b.type,g=b.originalEvent.wheelDelta&&(0<b.originalEvent.wheelDelta?1:-1)||b.originalEvent.detail&&(0<b.originalEvent.detail?-1:1),f=0,f=0;if("click"==e)f=m.offset().top-b.pageY,f=100*(f+m.height())/w.height();else if("mousewheel"==e||"DOMMouseScroll"==e)f=100*(m.height()+g)/w.height();0>f&&(f=0,n.attr("class","volume glyphicon glyphicon-volume-off"));50<f&&n.attr("class","volume glyphicon glyphicon-volume-up");0<f&&50>=f&&n.attr("class","volume glyphicon glyphicon-volume-down");100<=f&&(f=100);m.css("height",f+"%");c[0].volume=f/100;b.stopPropagation();b.preventDefault();a.stopPropagation();return!1});u.mousedown(function(a){a=a||h.event;var b=c[0].duration;a=100*(a.pageX-v.offset().left)/u.width();100<a&&(a=100);0>a&&(a=0);v.css("width",a+"%");c[0].currentTime=b*a/100});return r}})(jQuery,window,document);